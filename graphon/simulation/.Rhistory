tmp = load(list.files(pattern = path))
tmp = R_result
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters)],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[c(1,3,2)])],]),zlim=c(0,0.05))
k=1
path=path.list[[k]]
avai.inds = as.matrix(read.csv(paste('../processed_FunctionalData/',path,'/AvaiNeurons.csv',sep='')))
avai.inds=avai.inds[,-1];
locs.all = as.matrix(read.csv(paste('../processed_FunctionalData/',path,'/locs_all.csv',sep='')))
locs.all = locs.all[,-1]
locs=locs.all[avai.inds,]
member.ship = as.matrix(read.csv(paste('../processed_FunctionalData/',path,'/MembShip.csv',sep='')))
member.ship=member.ship[,-1];
mnx.all = as.matrix(read.csv(paste('../processed_FunctionalData/',path,'/mnx.csv',sep='')))
mnx.all = mnx.all[,-1]
mnx = mnx.all[avai.inds]
library(data.table)
dat.dFF=as.matrix(fread(paste('../processed_FunctionalData/',path,'/dFF.csv',sep='')))
dat.dFF=dat.dFF[,-1]
# Simply calculate the covariance among dFF within the time periods
# Obtain the list of missing traces
na.inds= is.na(dat.dFF[,1]);
reduced.dFF=dat.dFF[!na.inds,];
window_length = 240 # = 1min at 4 Hz
window_step = 240 # = 1min at 4Hz
n.intervals = (dim(reduced.dFF)[2]-window_length) %/% window_step + 1
interval.list = matrix(1:window_length, nrow=n.intervals, ncol=window_length, byrow=TRUE)
interval.list = interval.list + (1:n.intervals-1)*window_step
ave_dFF = matrix(nrow=dim(reduced.dFF)[1], ncol=n.intervals)
for(i in 1:n.intervals){
ave_dFF[,i] = rowMeans(reduced.dFF[,interval.list[i,]]);
}
tmp = load(list.files(pattern = path))
tmp = R_result
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[1]])],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[2]])],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[3]])],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[3]])],]),zlim=c(0,0.05))
path
tmp = L_result
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[1]])],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[2]])],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[3]])],]),zlim=c(0,0.05))
k=2
path=path.list[[k]]
avai.inds = as.matrix(read.csv(paste('../processed_FunctionalData/',path,'/AvaiNeurons.csv',sep='')))
avai.inds=avai.inds[,-1];
locs.all = as.matrix(read.csv(paste('../processed_FunctionalData/',path,'/locs_all.csv',sep='')))
locs.all = locs.all[,-1]
locs=locs.all[avai.inds,]
member.ship = as.matrix(read.csv(paste('../processed_FunctionalData/',path,'/MembShip.csv',sep='')))
member.ship=member.ship[,-1];
mnx.all = as.matrix(read.csv(paste('../processed_FunctionalData/',path,'/mnx.csv',sep='')))
mnx.all = mnx.all[,-1]
mnx = mnx.all[avai.inds]
library(data.table)
dat.dFF=as.matrix(fread(paste('../processed_FunctionalData/',path,'/dFF.csv',sep='')))
dat.dFF=dat.dFF[,-1]
# Simply calculate the covariance among dFF within the time periods
# Obtain the list of missing traces
na.inds= is.na(dat.dFF[,1]);
reduced.dFF=dat.dFF[!na.inds,];
window_length = 240 # = 1min at 4 Hz
window_step = 240 # = 1min at 4Hz
n.intervals = (dim(reduced.dFF)[2]-window_length) %/% window_step + 1
interval.list = matrix(1:window_length, nrow=n.intervals, ncol=window_length, byrow=TRUE)
interval.list = interval.list + (1:n.intervals-1)*window_step
ave_dFF = matrix(nrow=dim(reduced.dFF)[1], ncol=n.intervals)
for(i in 1:n.intervals){
ave_dFF[,i] = rowMeans(reduced.dFF[,interval.list[i,]]);
}
tmp = load(list.files(pattern = path))
tmp = R_result
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[3]])],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[1]])],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[3]])],]),zlim=c(0,0.05))
fields::image.plot(t(ave_dFF[tmp$id[unlist(tmp$clus_result$clusters[[2]])],]),zlim=c(0,0.05))
load("/Users/bgemily/Documents/Academic/SC/graphon/simulation/case2_NSim1000_20201001_1637.Rdata")
ARI = c()
for (result in results1) {
# tmp = sapply(result, function(tmp)get_one_ARI(memb_est_vec = clus2mem(tmp$clus_result$clusters),
# memb_true_vec = tmp$network$membership_true))
tmp = sapply(result, function(tmp)tryCatch(tmp$clus_result$ARI, error=function(x)0))
ARI = cbind(ARI, tmp)
}
ARI = as.data.frame(ARI)
# colnames(ARI) = names(results1)
colnames(ARI) = c(tau_max_vec,conn_prob_vec, beta_vec, alpha_vec,
clus_size_vec_list, conv_threshold_vec)
# colnames(ARI) = names(results1)
colnames(ARI) = c(tau_max_vec,conn_prob_vec, beta_vec, alpha_vec,
clus_size_vec_list)
# plot_jitter_boxplot(data=ARI[,], ylim=c(-0.1,1))
plot_pointrange(data=ARI[,])
plot_ARI_compr
plot_ARI_compr = function(ARI_our, ARI_ppsbm, ylim=c(0,1)){
data_tmp=rbind(reshape2::melt(ARI_our), reshape2::melt(ARI_ppsbm))
method = rep(c("our method","ppsbm"),each=dim(data_tmp)[1]/2)
data_tmp = cbind(data_tmp, method)
colnames(data_tmp) = c("V","ARI","method")
# grouped boxplot
ggplot(data_tmp, aes(x=V, y=ARI, group=method, col=method)) +
# geom_boxplot()+
stat_summary(geom = "line",fun=median)+
stat_summary(geom = "point",fun=median)+
stat_summary(geom = "errorbar",width=0.1,
fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) }
)+
coord_cartesian(ylim = ylim)+
theme_light() +
theme(
axis.title = element_blank(),
# legend.position="none",
plot.title = element_text(size=11)
) #+
# scale_x_discrete(guide = guide_axis(n.dodge=2, check.overlap = T))
}
plot_pointrange = function(data, ylim=c(0,1)){
library(ggplot2)
library(dplyr)
library(viridis)
data = reshape2::melt(data, id.vars=NULL, variable.name="name")
method = rep("1",time=dim(data)[1])
data %>%
# left_join(method) %>%
# mutate(myaxis = paste0(name)) %>%
ggplot( aes(x=name, y=value, col=method, group=method)) +
stat_summary(geom = "line",fun=median)+
stat_summary(geom = "point",fun=median)+
stat_summary(geom = "errorbar",width=0.1,
fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) }
)+
coord_cartesian(ylim=ylim)+
theme_light() +
theme(
axis.title = element_blank(),
legend.position="none",
plot.title = element_text(size=11)
) +
ggtitle("")
# coord_flip()
}
# plot_jitter_boxplot(data=ARI[,], ylim=c(-0.1,1))
plot_pointrange(data=ARI[,])
results1$tau_max_20[[1]]$clus_result$clusters_history
results1$conn_prob_0.2[[1]]$clus_result$clusters_history
path.list=list.files('../processed_FunctionalData/');
window_length
k=1
path=path.list[[k]]
dat.dFF=as.matrix(fread(paste('../processed_FunctionalData/',path,'/dFF.csv',sep='')))
dat.dFF=dat.dFF[,-1]
# Simply calculate the covariance among dFF within the time periods
# Obtain the list of missing traces
na.inds= is.na(dat.dFF[,1]);
reduced.dFF=dat.dFF[!na.inds,];
# Calculate the covariance/correlation matrices for each time interval
# n.intervals= round(dim(reduced.dFF)[2]/conn.interval,digits=0)
# interval.list=matrix(1:dim(reduced.dFF)[2],ncol=conn.interval,byrow=T)
# interval.list=interval.list[1:n.intervals,];
n.intervals = (dim(reduced.dFF)[2]-window_length) %/% window_step + 1
interval.list = matrix(1:window_length, nrow=n.intervals, ncol=window_length, byrow=TRUE)
interval.list = interval.list + (1:n.intervals-1)*window_step
cor.full=array(dim=c(n.intervals,dim(reduced.dFF)[1],dim(reduced.dFF)[1]))
for(i in 1:n.intervals){
dat.temp=reduced.dFF[,interval.list[i,]];
cor.full[i,,]=cor(x=t(dat.temp));
}
i=11;
plot(cor.full[,tmp_ind[13],tmp_ind[i]],type='l',col=1,xlim=c(0,250),ylim=c(0,1));
plot(cor.full[,13,16],type='l');
plot(cor.full[,13,1],type='l');
plot(cor.full[,13,4],type='l');
plot(cor.full[,23,24],type='l');
dim(cor.full)
load("/Users/bgemily/Documents/Academic/SC/graphon/simulation/func_20150417_Nclus3_MaxIter10_20200906_1913.Rdata")
load("/Users/bgemily/Documents/Academic/SC/graphon/simulation/func_20150410_Nclus3_MaxIter10_20200906_1912.Rdata")
tmp=L_result
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]])
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(0,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(0,1),col=2)
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=2,xlim=c(0,250),ylim=c(0,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=2,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=2,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][6]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][7]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][9]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][9]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][14]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][14]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[1]]][4]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][10]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,250),ylim=c(0,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][10]],
type='l',col=3,xlim=c(0,250),ylim=c(0,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,250),ylim=c(-0.2,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,250),ylim=c(-0.2,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][10]],
type='l',col=3,xlim=c(0,250),ylim=c(-0.2,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,250),ylim=c(-0.2,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,250),ylim=c(-0.2,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,250),ylim=c(-0.2,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][10]],
type='l',col=3,xlim=c(0,250),ylim=c(-0.2,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][10]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][10]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1))
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][5]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][6]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][7]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][9]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][5]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[1]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][5]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[1]]][1],
tmp$id[tmp$clus_result$clusters[[1]]][5]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][5]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][5]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][5]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][6]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][7]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
apply(cor.full[i:(min(i+4,n.intervals)),,,drop=F], c(2,3), mean)
cor.full.ave = cor.full
for(i in 1:(n.intervals-4)){
cor.full.ave[i,,]=apply(cor.full[i:(min(i+4,n.intervals)),,,drop=F], c(2,3), mean)>rho;
}
for(i in 1:(n.intervals-4)){
cor.full.ave[i,,]=apply(cor.full[i:(min(i+4,n.intervals)),,,drop=F], c(2,3), mean)
}
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
window_length = 1200 # = 1min at 4 Hz
n.intervals = (dim(reduced.dFF)[2]-window_length) %/% window_step + 1
interval.list = matrix(1:window_length, nrow=n.intervals, ncol=window_length, byrow=TRUE)
interval.list = interval.list + (1:n.intervals-1)*window_step
cor.full=array(dim=c(n.intervals,dim(reduced.dFF)[1],dim(reduced.dFF)[1]))
for(i in 1:n.intervals){
dat.temp=reduced.dFF[,interval.list[i,]];
cor.full[i,,]=cor(x=t(dat.temp));
}
plot(cor.full[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][2],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][10]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][9]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][7]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][6]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][2]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][12]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][113]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][13]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][13]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][5],
tmp$id[tmp$clus_result$clusters[[2]]][9]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][4],
tmp$id[tmp$clus_result$clusters[[2]]][9]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][4],
tmp$id[tmp$clus_result$clusters[[2]]][9]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][4],
tmp$id[tmp$clus_result$clusters[[2]]][7]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][4],
tmp$id[tmp$clus_result$clusters[[2]]][6]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][4],
tmp$id[tmp$clus_result$clusters[[2]]][6]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
abline(a=0.6)
abline(h=0.6)
abline(h=0.6,col=4)
abline(h=0.6,col=4,lty=2)
abline(h=0.6,col=4,lty=3)
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
abline(h=0.6,col=4,lty=3)
abline(h=0.6,col=4,lty=3)
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
abline(h=0.6,col=4,lty=2)
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][3]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
abline(h=0.6,col=4,lty=3)
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][4],
tmp$id[tmp$clus_result$clusters[[2]]][6]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
plot(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][1],
tmp$id[tmp$clus_result$clusters[[2]]][4]],
type='l',col=1,xlim=c(0,280),ylim=c(-0.2,1),ylab='',xlab='')
abline(h=0.6,col=4,lty=3)
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][3],
tmp$id[tmp$clus_result$clusters[[2]]][8]],
type='l',col=2,xlim=c(0,300),ylim=c(-0.2,1))
lines(cor.full.ave[,tmp$id[tmp$clus_result$clusters[[2]]][4],
tmp$id[tmp$clus_result$clusters[[2]]][6]],
type='l',col=3,xlim=c(0,300),ylim=c(-0.2,1))
